<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>Plutoo — Gold Edition</title>

  <!-- PWA base -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#0B0B0F" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="/plutoo-icon-192.png" />

  <!-- Icone -->
  <link rel="icon" type="image/png" sizes="32x32" href="/plutoo-icon-192.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/plutoo-icon-512.png" />

  <!-- Stili -->
  <link rel="stylesheet" href="/style.css" />
</head>
<body class="theme-gold">

  <!-- Topbar -->
  <header class="topbar">
    <div class="topbar-left">
      <img src="/plutoo-icon-192.png" alt="Plutoo" class="brand-icon" />
      <span class="brand-name">Plutoo</span>
    </div>

    <nav class="topbar-center">
      <!-- Nascosto in Home via hotfix; riappare nelle altre viste -->
      <button id="tab-nearby" class="chip" data-view="nearby">Vicino a te</button>
      <button id="tab-love" class="chip" data-view="love">Amore 🥲💛</button>
      <button id="tab-play" class="chip" data-view="play">Giochiamo 🥲🐕</button>
      <button id="tab-plus" class="chip" data-view="plus">Plus ⭐</button>
      <button id="tab-search" class="chip" data-view="search">Ricerca 🔍</button>
      <button id="tab-places" class="chip" data-view="places">Luoghi PET 🐾</button>
    </nav>

    <div class="topbar-right">
      <button id="btnLangIT" class="lang-btn" data-lang="it" aria-label="Italiano">🇮🇹</button>
      <button id="btnLangEN" class="lang-btn" data-lang="en" aria-label="English">🇬🇧</button>
      <button class="btn btn-outline" data-view="login">Login</button>
      <button class="btn btn-outline" data-view="register">Registrati</button>
    </div>
  </header>

  <main id="views">

    <!-- ============== HOME ================= -->
    <section id="view-home" class="view" aria-labelledby="home-title">
      <h1 id="home-title" class="visually-hidden">Plutoo — Home</h1>

      <div class="home-wrap">
        <!-- Logo grande -->
        <img src="/plutoo-icon-512.png" alt="Plutoo" class="hero-logo" />

        <!-- CTA Entra -->
        <div class="hero-actions">
          <button id="btnEnter" class="btn btn-gold btn-lg">ENTRA</button>
        </div>

        <!-- Sponsor -->
        <div class="home-sponsor">
          <div class="sponsor-badge">Sponsor ufficiale</div>
          <button id="sponsorFido" class="sponsor-card sponsor-card--home" type="button">
            <img src="/sponsor-logo.png" class="sponsor-logo" alt="Fido" />
            <div class="sponsor-copy">
              <div class="sponsor-title">Fido</div>
              <div class="sponsor-text">Il gelato per i nostri amici a quattro zampe</div>
            </div>
          </button>
        </div>

        <!-- Box etico -->
        <button id="btnEthic" class="ethic-cta" type="button">
          Non abbandonare mai i tuoi amici 🐾 (canili vicino a me)
        </button>
      </div>
    </section>

    <!-- ============== VICINO A TE (griglia 2x2) ============== -->
    <section id="view-nearby" class="view" hidden aria-labelledby="nearby-title">
      <h2 id="nearby-title" class="section-title">Vicino a te</h2>

      <div id="nearbyGrid" class="grid-2">
        <!-- popolato da app.js o hotfix -->
      </div>

      <div class="nearby-footer">
        <div class="sponsor-inline">
          <img src="/sponsor-logo.png" alt="Fido" />
          <span>Fido — il gelato per cani</span>
        </div>
        <button id="btnEthic2" class="ethic-cta" type="button">
          Non abbandonare mai i tuoi amici 🐾 (canili vicino a me)
        </button>
      </div>
    </section>

    <!-- ============== AMORE (swipe) ============== -->
    <section id="view-love" class="view" hidden aria-labelledby="love-title">
      <h2 id="love-title" class="section-title">Amore 🥲💛</h2>
      <div id="swipeArea" class="swipe-area">
        <div id="swipeCard" class="swipe-card frame-gold">
          <!-- carta generata da app.js -->
          <div class="placeholder">Fai swipe per iniziare 💛</div>
        </div>
        <div class="swipe-actions">
          <button id="btnDislike" class="btn btn-ghost">🥲</button>
          <button id="btnLike" class="btn btn-gold">💛</button>
        </div>
      </div>
      <div class="page-sponsor">
        <div class="sponsor-inline">
          <img src="/sponsor-logo.png" alt="Fido" />
          <span>Fido — il gelato per cani</span>
        </div>
      </div>
      <button id="btnEthic3" class="ethic-cta" type="button">
        Non abbandonare mai i tuoi amici 🐾 (canili vicino a me)
      </button>
    </section>

    <!-- ============== GIOCHIAMO ============== -->
    <section id="view-play" class="view" hidden aria-labelledby="play-title">
      <h2 id="play-title" class="section-title">Giochiamo 🥲🐕</h2>
      <div class="placeholder">Social e passeggiate in arrivo 💛</div>
      <div class="page-sponsor">
        <div class="sponsor-inline">
          <img src="/sponsor-logo.png" alt="Fido" />
          <span>Fido — il gelato per cani</span>
        </div>
      </div>
      <button id="btnEthic4" class="ethic-cta" type="button">
        Non abbandonare mai i tuoi amici 🐾 (canili vicino a me)
      </button>
    </section>

    <!-- ============== PLUS (abbonamento) ============== -->
    <section id="view-plus" class="view" hidden aria-labelledby="plus-title">
      <h2 id="plus-title" class="section-title">Plutoo Gold ⭐</h2>
      <div class="plus-wrap">
        <ul class="plus-list">
          <li>Rimuove tutti gli annunci</li>
          <li>Filtri Gold e funzioni Premium</li>
          <li>Supporto prioritario</li>
        </ul>
        <button id="btnBuyPlus" class="btn btn-gold">Attiva €39,90/anno</button>
      </div>
      <div class="page-sponsor">
        <div class="sponsor-inline">
          <img src="/sponsor-logo.png" alt="Fido" />
          <span>Fido — il gelato per cani</span>
        </div>
      </div>
    </section>

    <!-- ============== RICERCA ============== -->
    <section id="view-search" class="view" hidden aria-labelledby="search-title">
      <h2 id="search-title" class="section-title">Ricerca personalizzata 🔍</h2>
      <form id="filtersForm" class="filters">
        <div class="field">
          <label for="breed">Razza</label>
          <input id="breed" type="text" autocomplete="off" placeholder="Inizia a scrivere…" />
          <div id="breedSuggest" class="suggest"></div>
        </div>
        <div class="field">
          <label for="sex">Sesso</label>
          <select id="sex">
            <option value="">Qualsiasi</option>
            <option value="male">Maschio</option>
            <option value="female">Femmina</option>
          </select>
        </div>
        <div class="field check">
          <label><input id="verified" type="checkbox" /> Badge verificato Gold</label>
        </div>
        <div class="actions">
          <button type="reset" class="btn btn-ghost">Reset</button>
          <button type="submit" class="btn btn-gold">Applica</button>
        </div>
      </form>
      <div class="page-sponsor">
        <div class="sponsor-inline">
          <img src="/sponsor-logo.png" alt="Fido" />
          <span>Fido — il gelato per cani</span>
        </div>
      </div>
    </section>

    <!-- ============== LUOGHI PET ============== -->
    <section id="view-places" class="view" hidden aria-labelledby="places-title">
      <h2 id="places-title" class="section-title">Luoghi PET 🐾</h2>
      <div class="dropdown">
        <button class="dropdown-item" data-service="veterinari">Veterinari</button>
        <button class="dropdown-item" data-service="toelettature">Toelettature</button>
        <button class="dropdown-item" data-service="negozi">Negozi</button>
        <button class="dropdown-item" data-service="parchi">Parchi</button>
        <button class="dropdown-item" data-service="addestratori">Addestratori</button>
        <button class="dropdown-item" data-service="canili">Canili</button>
      </div>
      <div class="page-sponsor">
        <div class="sponsor-inline">
          <img src="/sponsor-logo.png" alt="Fido" />
          <span>Fido — il gelato per cani</span>
        </div>
      </div>
      <button id="btnEthic5" class="ethic-cta" type="button">
        Non abbandonare mai i tuoi amici 🐾 (canili vicino a me)
      </button>
    </section>

    <!-- ============== PROFILO DOG (modal semplice) ============== -->
    <section id="profilePage" class="sheet" hidden aria-labelledby="profileName">
      <div class="sheet-inner">
        <button id="btnCloseProfile" class="sheet-close" aria-label="Chiudi">✕</button>
        <div id="profileMainPhoto" class="profile-photo"></div>
        <h3 id="profileName" class="profile-name"></h3>
        <div id="profileInfo" class="profile-info"></div>
        <span id="badgeVerified" class="badge" hidden>Verificato Gold</span>
        <div class="profile-actions">
          <button class="btn btn-ghost">🥲</button>
          <button class="btn btn-gold">💛</button>
        </div>
      </div>
    </section>

    <!-- ============== Reward mock dialog ============== -->
    <dialog id="rewardDialog">
      <div class="dialog-inner">
        <h3>Video ricompensa</h3>
        <p>Guarda il video per sbloccare la funzione.</p>
        <div class="dialog-actions">
          <button id="rewardPlay" class="btn btn-gold">Guarda</button>
          <button id="rewardClose" class="btn btn-ghost">Chiudi</button>
        </div>
      </div>
    </dialog>

  </main>

  <!-- ====== HOTFIX inline: interazioni minime anche senza app.js ====== -->
  <script>
  (function () {
    function $(s, c=document){return c.querySelector(s)}
    function $$(s, c=document){return Array.from(c.querySelectorAll(s))}
    function escapeHTML(s){return s.replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[c]))}

    // dataset base per la griglia
    var dogs = [
      { id:1, name:"Luna",  breed:"Labrador",         age:3, img:"/dog1.jpg" },
      { id:2, name:"Rocky", breed:"Bulldog",          age:4, img:"/dog2.jpg" },
      { id:3, name:"Milo",  breed:"Golden Retriever", age:2, img:"/dog3.jpg" },
      { id:4, name:"Bella", breed:"Barboncino",       age:1, img:"/dog4.jpg" }
    ];

    function ensureNearbyGrid(){
      var grid = $("#nearbyGrid");
      if (!grid || grid.children.length) return;
      grid.innerHTML = "";
      dogs.forEach(function(d){
        var card = document.createElement("div");
        card.className = "card frame-gold";
        card.innerHTML =
          '<div class="card-photo"><img src="'+d.img+'" alt="'+escapeHTML(d.name)+'"></div>'+
          '<div class="card-info small"><div><strong>'+escapeHTML(d.name)+'</strong>, '+d.age+'</div>'+
          '<div>'+escapeHTML(d.breed)+'</div></div>';
        grid.appendChild(card);
      });
    }

    // show + nascondi/mostra tab "Vicino a te"
    window.show = function(view){
      var targetId = "view-" + view;
      $$(".view").forEach(function(v){
        if (v.id === targetId){ v.classList.add("view-active"); v.removeAttribute("hidden"); }
        else { v.classList.remove("view-active"); v.setAttribute("hidden",""); }
      });
      var nearTab = $("#tab-nearby");
      if (nearTab) nearTab.style.display = (view === "home") ? "none" : "";
      // evidenzia tab attivo se presente
      document.querySelectorAll('[data-view]').forEach(function(el){
        if (el.id && el.id.startsWith('tab-')) el.classList.toggle('active', el.dataset.view===view);
      });
      window.scrollTo({top:0, behavior:"smooth"});
      if (view === "nearby") ensureNearbyGrid();
    };

    document.addEventListener("DOMContentLoaded", function(){
      // Home visibile all'avvio
      $$(".view").forEach(function(v){
        if (v.id === "view-home"){ v.classList.add("view-active"); v.removeAttribute("hidden"); }
        else { v.classList.remove("view-active"); v.setAttribute("hidden",""); }
      });
      var nearTab = $("#tab-nearby"); if (nearTab) nearTab.style.display = "none";

      // ENTRA
      $("#btnEnter")?.addEventListener("click", function(e){ e.preventDefault(); show("nearby"); });

      // Delegazione tab
      document.addEventListener("click", function(e){
        var b = e.target.closest("[data-view]");
        if (b && b.dataset.view){ e.preventDefault(); show(b.dataset.view); }
      });

      // Sponsor + Etica (apre Google Maps)
      function openMaps(q){ window.open('https://www.google.com/maps/search/'+encodeURIComponent(q), '_blank', 'noopener'); }
      $("#sponsorFido")?.addEventListener("click", function(){ openMaps("Fido il gelato per cani"); });
      $("#btnEthic")?.addEventListener("click", function(){ openMaps("canili vicino a me"); });
      $("#btnEthic2")?.addEventListener("click", function(){ openMaps("canili vicino a me"); });
      $("#btnEthic3")?.addEventListener("click", function(){ openMaps("canili vicino a me"); });
      $("#btnEthic4")?.addEventListener("click", function(){ openMaps("canili vicino a me"); });
      $("#btnEthic5")?.addEventListener("click", function(){ openMaps("canili vicino a me"); });
    });
  })();
  </script>
  <!-- ====== /HOTFIX ====== -->

  <!-- Quando app.js sarà ok, questo prende il controllo (lasciare così) -->
  <script src="/app.js"></script>
</body>
</html>
